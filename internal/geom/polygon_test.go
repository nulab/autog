package geom

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestMergeRects(t *testing.T) {
	rects := []Rect{
		{P{305, 1}, P{348, 52}},
		{P{181, 52}, P{345, 103}},
		{P{259, 103}, P{318, 154}},
		{P{1, 154}, P{282, 205}},
		{P{78, 205}, P{162, 256}},
		{P{137, 256}, P{391, 307}},
		{P{18, 307}, P{240, 358}},
		{P{175, 358}, P{367, 409}},
		{P{251, 409}, P{471, 460}},
		{P{174, 460}, P{341, 511}},
	}

	poly := MergeRects(rects)

	want := []P{
		{305, 1}, {305, 52}, {181, 52}, {181, 103}, {259, 103}, {259, 154}, {1, 154}, {1, 205}, {78, 205}, {78, 256},
		{137, 256}, {137, 307}, {18, 307}, {18, 358}, {175, 358}, {175, 409}, {251, 409}, {251, 460}, {174, 460}, {174, 511},
		{341, 511}, {341, 460}, {471, 460}, {471, 409}, {367, 409}, {367, 358}, {240, 358}, {240, 307}, {391, 307}, {391, 256},
		{162, 256}, {162, 205}, {282, 205}, {282, 154}, {318, 154}, {318, 103}, {345, 103}, {345, 52}, {348, 52}, {348, 1},
	}
	for i := range poly.Points {
		assert.Equal(t, want[i], poly.Points[i])
	}
}
